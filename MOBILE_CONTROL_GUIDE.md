# 手机控制功能使用指南

## 📱 功能概述

手机控制功能允许您通过手机扫描二维码，远程控制内网大屏的抽奖操作，实现更灵活的互动方式。

---

## 🎯 核心功能

### 1. 二维码扫码控制
- 大屏显示二维码
- 手机扫描即可连接
- 输入验证码验证身份

### 2. 权限管理
- **总开关**：可随时开启/关闭手机控制功能
- **验证码**：自定义验证码，仅管理员可见
- **锁定/解锁**：大屏锁定后，手机无法操作
- **界面限制**：仅在大屏显示抽奖界面时可操作

### 3. 安全机制
- 单设备连接限制
- 管理员密码验证
- 完整操作日志
- 断线需重新验证

---

## 🚀 快速开始

### 步骤 1：配置手机控制

1. 登录系统
2. 进入 **配置 → 全局配置 → 手机控制**
3. 确保总开关已开启
4. 查看或修改验证码（默认：123456）

### 步骤 2：大屏连接

1. 打开抽奖主页面
2. 确保大屏处于**开锁状态** 🔓
3. 鼠标悬停在"开始抽奖"按钮上
4. 显示二维码后，用手机扫描

### 步骤 3：手机登录

1. 扫描二维码后跳转到手机登录页面
2. 输入验证码（例如：123456）
3. 点击"登录"

### 步骤 4：手机控制

登录成功后，手机显示控制面板：
- **开始抽奖**：控制大屏开始抽奖
- **停止抽奖**：控制大屏停止抽奖

---

## 🔒 锁定/解锁功能

### 锁定大屏

1. 在大屏右上角点击锁图标 🔓
2. 大屏状态变为 🔒（锁定）
3. 手机无法进行任何操作

### 解锁大屏

1. 在大屏右上角点击锁图标 🔒
2. 输入管理员密码（LOGIN_CONFIG.md 中设置的密码）
3. 大屏状态变为 🔓（开锁）
4. 手机可以正常操作

---

## 📝 配置说明

### 手机控制设置页面

**位置**：配置 → 全局配置 → 手机控制

#### 总开关
- 开启/关闭手机控制功能
- 关闭后所有手机无法连接

#### 验证码设置
- 默认验证码：`123456`
- 修改验证码需要管理员密码
- 验证码格式：4-8位数字

#### 连接状态
- 显示当前连接设备数量
- 只允许一台手机同时连接

#### 操作日志
- 记录所有操作
- 支持查看和清空

---

## ⚠️ 使用限制

### 手机无法操作的情况

1. **大屏已锁定** 🔒
   - 解决：管理员解锁大屏

2. **大屏不在抽奖界面**
   - 解决：返回抽奖主页面

3. **手机控制功能已关闭**
   - 解决：在配置页面开启功能

4. **已有其他设备连接**
   - 解决：等待其他设备断开连接

5. **验证码错误**
   - 解决：输入正确的验证码

---

## 🔄 断线重连

### 手机断开连接

- 网络断开
- 大屏关闭
- 超时自动断开（30秒无心跳）

### 重新连接

1. 重新扫描二维码
2. 重新输入验证码登录
3. 无需重启服务

---

## 📊 操作日志

### 日志记录内容

- 手机连接/断开
- 验证码验证（成功/失败）
- 开始/停止抽奖操作
- 锁定/解锁操作
- 功能开关切换

### 查看日志

**位置**：配置 → 全局配置 → 手机控制 → 操作日志

### 日志存储

- 文件位置：`logs/mobile-control.log`
- 自动创建
- 支持清空

---

## 🔐 安全建议

1. **定期更换验证码**
   - 每次活动前更换新验证码
   - 避免使用简单密码

2. **及时锁定大屏**
   - 不需要手机控制时及时锁定
   - 防止误操作

3. **检查操作日志**
   - 定期查看操作日志
   - 发现异常及时处理

4. **管理好管理员密码**
   - 不要泄露管理员密码
   - 定期更换密码

---

## 📱 手机端界面说明

### 登录页面

```
📱 手机控制登录
扫码后输入验证码连接大屏

[ 1 2 3 4 ]  ← 验证码输入框

提示：请确保大屏幕已启动并处于开锁状态
```

### 控制面板

```
🎮 抽奖控制面板
[开始抽奖] [停止抽奖]

状态：✅ 可以控制
      🔴 大屏已锁定
      🟠 大屏不在抽奖界面
```

---

## 🛠️ 故障排除

### 问题1：扫描二维码后无法连接

**可能原因**：
- 大屏不在抽奖界面
- 大屏已锁定
- 手机控制功能已关闭

**解决方法**：
1. 确保大屏在抽奖主页面
2. 解锁大屏
3. 在配置页面开启手机控制

### 问题2：验证码输入错误

**可能原因**：
- 验证码输入错误
- 验证码已被修改

**解决方法**：
1. 确认当前验证码（配置页面查看）
2. 重新输入正确的验证码

### 问题3：手机点击按钮无反应

**可能原因**：
- 大屏已锁定
- 大屏不在抽奖界面

**解决方法**：
1. 检查大屏状态
2. 解锁大屏
3. 返回抽奖页面

### 问题4：显示"已有设备正在控制"

**可能原因**：
- 另一台手机已连接

**解决方法**：
- 等待其他设备断开连接
- 或在配置页面查看连接状态

---

## 💡 使用技巧

1. **快速连接**：提前验证码告知操作人员，活动现场快速连接
2. **临时锁定**：中场休息时锁定大屏，防止误操作
3. **多轮抽奖**：保持连接，连续控制多轮抽奖
4. **日志监控**：活动期间实时查看操作日志

---

## 📞 技术支持

如遇问题，请检查：

1. 网络连接是否正常
2. 大屏是否在抽奖界面
3. 大屏是否处于开锁状态
4. 验证码是否正确
5. 操作日志中的错误信息

---

**版本**: v1.0.0
**更新时间**: 2024年12月30日
