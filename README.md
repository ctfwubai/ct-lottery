### é¡¹ç›®è¯´æ˜
æœ¬é¡¹ç›®åŸºäºå¼€æºé¡¹ç›® log-lotteryï¼ˆ[åŸé¡¹ç›®åœ°å€](https://github.com/LOG1997/log-lottery)ï¼‰è¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œæ ¸å¿ƒä»£ç æºè‡ª LOG1997 å¤§ä½¬ 2025 å¹´ 12 æœˆåˆçš„ç‰ˆæœ¬ã€‚
åŸé¡¹ç›®æ˜¯ä¸€æ¬¾åŸºäº Vue3 + Three.js æ„å»ºçš„ç‚«é…· 3D çƒä½“æŠ½å¥–åº”ç”¨ï¼Œå¼€ç®±å³ç”¨ã€å¯é«˜åº¦å®šåˆ¶ï¼Œé€‚ç”¨äºå¹´ä¼šç­‰å„ç±»æŠ½å¥–åœºæ™¯ï¼Œæ”¯æŒå¥–å“é…ç½®ã€äººå‘˜ç®¡ç†ã€ç•Œé¢è‡ªå®šä¹‰ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚
æœ¬äºŒæ¬¡å¼€å‘ç‰ˆæœ¬åœ¨åŸé¡¹ç›®ç¨³å®šæ¶æ„çš„åŸºç¡€ä¸Šï¼Œé’ˆå¯¹å®é™…ä½¿ç”¨åœºæ™¯è¡¥å……äº†ä¸ªæ€§åŒ–åŠŸèƒ½é€‚é…ï¼Œä¿æŒäº†åŸé¡¹ç›®çš„æ ¸å¿ƒä½“éªŒä¸æŠ€æœ¯ä¼˜åŠ¿ï¼ŒåŒæ—¶ä¼˜åŒ–äº†éƒ¨åˆ†ä½¿ç”¨ç»†èŠ‚ï¼Œæ„Ÿè°¢ LOG1997 å¤§ä½¬çš„å¼€æºè´¡çŒ®ï¼

### 1.æ‰“å¼€å¤§å±ä¸»é¡µ

- ##### ç™»å½•è´¦å·ï¼šadmin  å¯†ç ï¼šadmin123

- ##### å³ä¾§æŒ‰é’®ä»‹ç»

  - ç‚¹å‡»é”å®š

  >1.é”å®šå¤§å±æ‰‹æœºæ˜¯æ— æ³•æ“ä½œæŠ½å¥–çš„ã€‚è§£é”åæ­£å¸¸

  - é‡ç½®æŒ‰é’®

  > 1.åˆå§‹åŒ–æ‰€æœ‰æ•°æ® ï¼ˆéœ€è¦è¾“å…¥ç®¡ç†å¯†ç :admin888ï¼‰

<img width="1891" height="959" alt="image" src="https://github.com/user-attachments/assets/281ae84f-f0f3-4766-aaff-dbc90b375b2d" />


  - æ¢å¤é£˜èˆæŒ‰é’®

  > 1.æ‰“æ•£äººå‘˜åå•å¡ç‰‡æ’åº
<img width="1909" height="1045" alt="image" src="https://github.com/user-attachments/assets/922f55fa-067c-43a7-894c-11ec85390d9e" />


- æŸ¥çœ‹ä¸­å¥–äººå‘˜åå•æŒ‰é’®

> 1.å¯æŸ¥çœ‹å’Œç­›é€‰ä¸­å¥–çš„äººå‘˜åå•ï¼Œå±•ç¤ºä½œç”¨ã€‚
>
> 2.å¯é€‰æŒ‡å®šäººå‘˜ï¼Œä»ä¸­å¥–åå•ä¸­è·³è¿‡ã€‚è¿™æ˜¯é¿å…ä¸­å¥–çš„äººå‘˜ä¸åœ¨ç°åœºï¼Œé‡æ–°æŠŠæœºä¼šç•™ç»™ç°åœºäººå‘˜ã€‚

<img width="1899" height="1054" alt="image" src="https://github.com/user-attachments/assets/a3fdac48-1bc4-466f-ad39-13eea0ae5cc7" />


<img width="1797" height="1009" alt="image" src="https://github.com/user-attachments/assets/1377f5d0-f305-40d3-914c-3945c870a1ab" />

- é€€å‡ºæŒ‰é’®

> 1.é€€å‡ºå½“å‰ç™»å½•é¡µé¢

<img width="1898" height="1069" alt="image" src="https://github.com/user-attachments/assets/bcb2a623-f0c0-4345-8752-e4265d2f1415" />



---

### ä»¥ä¸‹æˆ‘åªä»‹ç»æˆ‘å¢åŠ çš„åŠŸèƒ½

##### 1.äººå‘˜é…ç½®-äººå‘˜åˆ—è¡¨

> 1.å¢åŠ å¯¼å‡º
>
> 2.å¢åŠ æ‰‹å·¥æ·»åŠ äººå‘˜ä¿¡æ¯

<img width="1902" height="1078" alt="image" src="https://github.com/user-attachments/assets/6c472253-25d5-421f-8502-6386d796c550" />

<img width="1712" height="991" alt="image" src="https://github.com/user-attachments/assets/2aeb68df-a895-4c17-9158-09baa1a32af2" />




##### 2.äººå‘˜é…ç½®-ä¸­å¥–äººå‘˜

> 1.å¢åŠ å¯¼å‡ºä¸­å¥–äººå‘˜åå•ä¸ºexcelæ ¼å¼ï¼Œæ–¹ä¾¿æ•´ç†ï¼Œå’Œç­¾å­—ï¼Œæäº¤ç»™è´¢åŠ¡æŠ¥è´¦ã€‚
>
> 2.ç§»å…¥æœªä¸­å¥–åå•ï¼Œç›¸å½“å¦‚æŠŠäººå‘˜ä¿¡æ¯é‡æ–°æŠ•å…¥å¥–æ± ã€‚

<img width="1904" height="960" alt="image" src="https://github.com/user-attachments/assets/6a676997-48d3-439a-8c78-4dd52e3bf4fc" />


##### 1.å¥–å“é…ç½®

> 1.ä¼˜åŒ–äº†å•è¯æŠ½å–ä¸ªæ•°ã€‚å¯ä»¥è‡ªå·±æ‰‹åŠ¨è‡ªå®šä¹‰è¾“å…¥ã€‚

<img width="1907" height="1012" alt="image" src="https://github.com/user-attachments/assets/c66203a4-8f81-4168-a7c5-8625c9c37779" />

<img width="1920" height="1047" alt="image" src="https://github.com/user-attachments/assets/ff780d4b-014a-47d6-9707-8f2b3823831b" />



##### 4.å…¨å±€é…ç½®-ç•Œé¢è®¾ç½®

> 1.å¢åŠ äº†æ ‡é¢˜å­—ä½“å¤§å°é…ç½®
>
> 2.å¢åŠ äº†æ ‡é¢˜å­—ä½“é¢œè‰²ä¿®æ”¹


<img width="1508" height="723" alt="image" src="https://github.com/user-attachments/assets/1e94d83a-5840-4cca-8986-b38ee9e24187" />


##### 5.å…¨å±€é…ç½®-å­—ä½“ç®¡ç†

> 1.å¢åŠ äº†ä¸Šä¼ å­—ä½“ å’Œé¢„è§ˆé…ç½®çš„é€‰é¡¹ï¼Œä¸»è¦é’ˆå¯¹é¦–é¡µä¸»é¢˜çš„ï¼Œä½†å¥½åƒæ˜¯æ²¡ä»€ä¹ˆç”¨ï¼Œå°±æ²¡æœ‰ç»§ç»­å»å¤„ç†è¿™ä¸ªé—®é¢˜äº†ã€‚åç»­æœ‰æ—¶é—´å†çœ‹äº†ã€‚

<img width="1899" height="893" alt="image" src="https://github.com/user-attachments/assets/f18467ba-d017-4e89-8350-2aa0b11b2dec" />


##### 6.å…¨å±€é…ç½®-é…ç½®æ¨¡æ¿

> 1.å¢åŠ äº†é…ç½®æ¨¡æ¿é¡µï¼šä¸»è¦ç›®çš„æ˜¯å½“ä½ é…ç½®äº†ä¸€äº›å‚æ•°ä¿¡æ¯ï¼Œå¯ä»¥æ”¯æŒå¯¼å‡ºå’Œä¿å­˜ï¼Œä¸‹æ¬¡éœ€è¦ä½¿ç”¨çš„æ—¶å€™å¯ä»¥å¿«é€Ÿå¯¼å…¥å’Œåº”ç”¨ã€‚

<img width="1903" height="920" alt="image" src="https://github.com/user-attachments/assets/757cbf87-51b7-44f1-90f6-58105d5d7ec3" />




##### 7.å…¨å±€é…ç½®-æ‰‹æœºæ§åˆ¶

> 1.å¯ç”¨æ‰‹æœºæ§åˆ¶å¼€å…³ï¼Œå…³é—­åï¼ŒæŠ½å¥–é¦–é¡µï¼Œé¼ æ ‡æ»‘è¿‡æŒ‰é’®çš„æ—¶å€™ä¸ä¼šæ˜¾ç¤ºäºŒç»´ç ã€‚å¼€å¯å°±ä¼šæ˜¾ç¤ºã€‚
>
> 2.å½“ä½ çš„ç”µè„‘æœ‰å¤šå¿«ç½‘å¡çš„æ—¶å€™ï¼Œä½ å¸Œæœ›æ‰‹æœºæ‰«ç åï¼Œç›´æ¥è·³è½¬åˆ°æŒ‡å®šçš„IPåœ°å€æˆ–è€…åŸŸåã€‚è¿™é‡Œéƒ½å¯ä»¥è‡ªå®šä¹‰çš„ã€‚
>
> 3.æ‰‹æœºæ‰«ç è·³è½¬åˆ°æ‰‹æœºæ§åˆ¶é¡µé¢ï¼Œéœ€è¦è¾“å…¥å¯†ç æ‰èƒ½ç™»å½•ï¼Œæ­¤å¤„å°±æ˜¯ä¿®æ”¹å’ŒæŒ‡å®šéªŒè¯ç çš„ã€‚é»˜è®¤éªŒè¯ç æ˜¯ï¼š123456
>
> **æ³¨æ„ï¼šæ‰‹æœºç½‘ç»œå’Œåº”ç”¨ç½‘ç»œå¿…é¡»è¦èƒ½å¤Ÿäº’ç›¸è®¿é—®**
>
> 4.æ‰‹æœºè¿æ¥çŠ¶æ€
>
> 5.æ‰‹æœºè¿æ¥åçš„æ“ä½œæ—¥å¿—ã€‚

<img width="1891" height="927" alt="image" src="https://github.com/user-attachments/assets/82d0ac64-a668-4574-bcd7-9fd6090da291" />

<img width="1661" height="583" alt="image" src="https://github.com/user-attachments/assets/1ce02c76-8e8d-4ef0-a414-d7c1c8d661de" />

<img width="1697" height="1033" alt="image" src="https://github.com/user-attachments/assets/8d0799cf-98f4-4929-bb7f-fb48a517754f" />


##### 8..ç³»ç»Ÿè®¾ç½®

> æ­¤å¤„å°±çœ‹å„ä½è‡ªå·±å»æ¢ç©¶äº†ï¼Œä½†ç»å¯¹æ˜¯å¤§å®¶æƒ³è¦çš„

<img width="1893" height="777" alt="image" src="https://github.com/user-attachments/assets/e2075617-17d5-4d6b-bb7f-0e9949642432" />

<img width="1623" height="1032" alt="image" src="https://github.com/user-attachments/assets/2e395b12-942a-4f6e-89f7-49217176e17d" />


##### 9..æ“ä½œè¯´æ˜

> æ‡’å¾—ä¼˜åŒ–ï¼Œä¹Ÿæ‡’å¾—ä¿®å¤ã€‚



##### 10.æ‰‹æœºç«¯æ“ä½œã€‚

> 1.å½“å½“å‰å¥–é¡¹æŠ½å–å®Œæˆåï¼Œæ‰‹æœºçš„å¼€å§‹æŠ½å¥–åŠŸèƒ½ä¼šå˜æˆç°è‰²ï¼Œæ— æ³•æ“ä½œã€‚
>
> 2.æŸ¥çœ‹ä¸­å¥–åå•ï¼Œå¯ä»¥è°ƒå‡ºå¤§å±ä¸Šçš„ä¸­å¥–åå•ï¼Œä½†æœ‰å‰ææ¡ä»¶ï¼Œå¿…é¡»å½“å‰å¥–é¡¹å…¨éƒ¨æŠ½å–å®Œæ¯•å¯ä»¥ä½¿ç”¨ã€‚å¦åˆ™åªæ”¯æŒå¤§å±é¼ æ ‡ç‚¹å‡»ä½¿ç”¨
<img width="1921" height="938" alt="image" src="https://github.com/user-attachments/assets/0ed95841-64d6-4891-b4a9-70335e65e795" />



<img width="464" height="947" alt="image" src="https://github.com/user-attachments/assets/aeb6dfa3-59b1-4aa2-939d-daf261282e70" />

<img width="487" height="957" alt="image" src="https://github.com/user-attachments/assets/1c1ccc9c-a4a4-4994-9fb3-99e6b19ee8c5" />

-------------------------------------------------------------------------------------------------------------------------------------------------------
# CTF-lottery æŠ½å¥–ç¨‹åºéƒ¨ç½²(Ubuntu)è¯´æ˜

>windows ç³»ç»Ÿä¸Šæµ‹è¯•è°ƒè¯•è¿è¡Œ (ä»¥ä¸‹æµ‹è¯•ç¯å¢ƒè¿è¡Œï¼ŒæˆåŠŸæ˜¯æœ‰æ¡ä»¶çš„ï¼Œåœ¨è¿™é‡Œä¸å¤šè§£é‡Šã€‚)
>
>åç«¯ï¼šD:\ftp\choujiang\ct-lottery-main>node server.cjs 
>
>å‰ç«¯ï¼šD:\ftp\choujiang\ct-lottery-main>start.bat 

### ä¸€ã€å‡†å¤‡é˜¶æ®µ

#### 1.1 è¿æ¥åˆ° Ubuntu æœåŠ¡å™¨

```
# ä½¿ç”¨ SSH è¿æ¥
ssh username@your-server-ip
# ä¾‹å¦‚ï¼šssh root@192.168.1.100
```

#### 1.2 æ›´æ–°ç³»ç»Ÿ

```
sudo apt update
sudo apt upgrade -y
```

#### 1.3 å®‰è£…å¿…è¦å·¥å…·

```
sudo apt install -y git curl wget build-essential unzip
```

### äºŒã€å®‰è£… Node.js 18.x

```
# ä½¿ç”¨ NodeSource å®˜æ–¹ä»“åº“
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -

# å®‰è£… Node.js
sudo apt-get install -y nodejs

# éªŒè¯å®‰è£…
node -v  # åº”æ˜¾ç¤º v18.x.x
npm -v   # åº”æ˜¾ç¤º v9.x.x æˆ–æ›´é«˜
```

### ä¸‰ã€å®‰è£…å’Œé…ç½® Nginx

```sudo apt install -y nginx
# å¯åŠ¨ Nginx
sudo systemctl start nginx

# è®¾ç½®å¼€æœºè‡ªå¯
sudo systemctl enable nginx

# éªŒè¯çŠ¶æ€
sudo systemctl status nginx
```

#### 3.2 éªŒè¯ Nginx

```
# æµ‹è¯•é…ç½®
sudo nginx -t

# åœ¨æµè§ˆå™¨è®¿é—®
http://æœåŠ¡å™¨IP
```

### å››ã€éƒ¨ç½²æŠ½å¥–ç³»ç»Ÿ

#### 4.1 ä¸Šä¼ æ–‡ä»¶

```
# ä¸Šä¼ å‹ç¼©åŒ…åˆ° /optç›®å½•ï¼Œè§£å‹
root@u-208:/opt#7z x ct-lottery-main.7z 

#cd /opt/ct-lottery-main

```

### 4.2 åˆ›å»ºé¡¹ç›®ç›®å½•

```
# åˆ›å»ºéƒ¨ç½²ç›®å½•
sudo mkdir -p /var/www/ct-lottery-main

# è®¾ç½®æ‰€æœ‰è€…ï¼ˆå°† username æ›¿æ¢ä¸ºæ‚¨çš„ç”¨æˆ·åï¼‰
sudo chown -R $root:$root /opt/ct-lottery-main
sudo chown -R $root:$root /var/www/ct-lottery
```



#### 4.3 å®‰è£…ä¾èµ–

```
cd /opt/ct-lottery-main

# ä½¿ç”¨ npmï¼ˆæ¨èï¼‰
npm install --legacy-peer-deps

# æˆ–ä½¿ç”¨ pnpm
# npm install -g pnpm
# pnpm install
```

#### 4.4 æ„å»ºé¡¹ç›®

```npm run build
npm run build
```

<img width="625" height="137" alt="image" src="https://github.com/user-attachments/assets/e8cf9159-a4ca-4fd3-80ce-5d5e91b6d501" />


æç¤ºï¼šæƒé™é—®é¢˜ï¼vue-tsc æ²¡æœ‰æ‰§è¡Œæƒé™ã€‚

## è§£å†³æ–¹æ¡ˆ

```
# æ–¹æ³•ä¸€ï¼šä¿®å¤ node_modules æƒé™ï¼ˆæ¨èï¼‰
chmod +x node_modules/.bin/vue-tsc
chmod +x node_modules/.bin/vite

# é‡æ–°æ„å»º

npm run build

```

æç¤ºè¿™ä¸ªï¼š

<img width="717" height="230" alt="image" src="https://github.com/user-attachments/assets/d12b0f1d-836c-4b44-8d11-9fc3777aae1c" />


é‚£å°±ç”¨è¿™ä¸ªå‘½ä»¤ï¼š

```
npm install --legacy-peer-deps
npx vite build
```

<img width="712" height="748" alt="image" src="https://github.com/user-attachments/assets/e7bad165-fc8f-4aec-9382-f931de33f086" />




æ„å»ºæˆåŠŸåä¼šç”Ÿæˆ `dist` æ–‡ä»¶å¤¹ã€‚

### äº”ã€éƒ¨ç½²å‰ç«¯æ–‡ä»¶

```
# å¤åˆ¶æ„å»ºæ–‡ä»¶åˆ°éƒ¨ç½²ç›®å½•
sudo cp -r dist/* /var/www/ct-lottery/

# å¤åˆ¶å¿…è¦çš„èµ„æºæ–‡ä»¶
sudo cp -r public/fonts /var/www/ct-lottery/
sudo cp -r public/templates /var/www/ct-lottery/

# è®¾ç½®æ­£ç¡®çš„æƒé™
sudo chown -R www-data:www-data /var/www/ct-lottery
sudo chmod -R 755 /var/www/ct-lottery

# éªŒè¯æ–‡ä»¶
ls -la /var/www/ct-lottery/
```
<img width="756" height="518" alt="image" src="https://github.com/user-attachments/assets/7a3b48c6-0fc5-4a08-bd02-746129e8e32d" />


-------------

### å…­ã€åˆ›å»º systemd æœåŠ¡æ–‡ä»¶

```
sudo vim /etc/systemd/system/lottery-backend.service
```

æ³¨æ„é—®é¢˜ç‚¹ï¼š

###### 1. å…ˆæ£€æŸ¥ Node.js å®é™…è·¯å¾„

```
which node
```

è®°ä¸‹è¿”å›çš„è·¯å¾„ã€‚

###### 2. æ£€æŸ¥ server.cjs æ˜¯å¦å­˜åœ¨

```
ls -la /opt/ct-lottery-main/server.cjs
```



```
ä¿®æ”¹ ExecStart è¡Œï¼Œå°† /usr/bin/node æ›¿æ¢ä¸ºå®é™…çš„ Node.js è·¯å¾„ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœ which node è¿”å› /root/.nvm/versions/node/v20.19.0/bin/nodeï¼Œåˆ™æ”¹ä¸ºï¼š

ExecStart=/root/.nvm/versions/node/v20.19.0/bin/node /opt/ct-lottery-main/server.cjs
```


<img width="1684" height="465" alt="image" src="https://github.com/user-attachments/assets/52bb75c9-95bf-4161-89b1-1098e8b32785" />




ç²˜è´´ä»¥ä¸‹å†…å®¹ï¼š

```
[Unit]
Description=Lottery Backend Server
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/opt/ct-lottery-main
Environment=NODE_ENV=production
Environment=PORT=3001
ExecStart=/usr/bin/node /opt/ct-lottery-main/server.cjs
Restart=always
RestartSec=10
StandardOutput=syslog
StandardError=syslog
SyslogIdentifier=lottery-backend

[Install]
WantedBy=multi-user.target

```

##### å¯åŠ¨å’Œç®¡ç†æœåŠ¡

```
# é‡è½½ systemd é…ç½®
sudo systemctl daemon-reload

# å¯åŠ¨æœåŠ¡
sudo systemctl start lottery-backend

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo systemctl status lottery-backend

# è®¾ç½®å¼€æœºè‡ªå¯
sudo systemctl enable lottery-backend

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
sudo journalctl -u lottery-backend -f

# åœæ­¢æœåŠ¡
sudo systemctl stop lottery-backend

# é‡å¯æœåŠ¡
sudo systemctl restart lottery-backend

```
<img width="722" height="310" alt="image" src="https://github.com/user-attachments/assets/e5364f82-d957-47f9-9499-8323a9e67dd3" />


##### éªŒè¯æœåŠ¡

```
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo systemctl status lottery-backend

# æµ‹è¯•åç«¯ API
curl http://localhost:3001/api/fonts

```

<img width="730" height="61" alt="image" src="https://github.com/user-attachments/assets/d4b825a5-bef3-475b-90ec-a7a07b2bb1fd" />


----

### ä¸ƒã€é…ç½® Nginx

#### 7.1 åˆ›å»º Nginx é…ç½®æ–‡ä»¶

```
sudo vim /etc/nginx/sites-available/ct-lottery
```

ç²˜è´´ä»¥ä¸‹å†…å®¹ï¼š

```
server {
    listen 80;
    server_name _;

    charset utf-8;

    root /var/www/ct-lottery;
    index index.html;

    access_log /var/log/nginx/ct-lottery-access.log;
    error_log /var/log/nginx/ct-lottery-error.log;

    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_comp_level 6;
    gzip_types
        text/plain
        text/css
        text/xml
        text/javascript
        application/json
        application/javascript
        application/x-javascript
        application/xml+rss;

    location / {
        try_files $uri $uri/ /index.html;
    }

    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
        access_log off;
    }

    location /fonts/ {
        alias /var/www/ct-lottery/fonts/;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    location /templates/ {
        alias /var/www/ct-lottery/templates/;
    }

    location /api/ {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_cache_bypass $http_upgrade;
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    location /ws/ {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_read_timeout 86400;
    }

    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }
}

```

#### 7.2 å¯ç”¨é…ç½®

```
# åˆ é™¤é»˜è®¤é…ç½®
sudo rm /etc/nginx/sites-enabled/default

# åˆ›å»ºè½¯é“¾æ¥
sudo ln -s /etc/nginx/sites-available/ct-lottery /etc/nginx/sites-enabled/

# æµ‹è¯•é…ç½®
sudo nginx -t

# å¦‚æœæ˜¾ç¤º "syntax is ok" å’Œ "test is successful"ï¼Œé‡å¯ Nginx
sudo systemctl restart nginx

# æŸ¥çœ‹ Nginx çŠ¶æ€
sudo systemctl status nginx

```

### å…«ã€æµ‹è¯•éƒ¨ç½²

#### 8.1 æœ¬åœ°æµ‹è¯•

```
# æµ‹è¯•å‰ç«¯
curl http://localhost

# æµ‹è¯•åç«¯ API
curl http://localhost:3001/api/fonts

# æµ‹è¯• Nginx ä»£ç†
curl http://localhost/api/fonts

```

#### 8.2 å¤–ç½‘æµ‹è¯•

åœ¨æµè§ˆå™¨è®¿é—®ï¼š

```
http://æœåŠ¡å™¨IP
# æˆ–
https://your-domain.com
```

---

### Ubuntu å¸¸è§é—®é¢˜

#### 1. ç«¯å£è¢«å ç”¨

```
# æŸ¥çœ‹å ç”¨ç«¯å£çš„è¿›ç¨‹
sudo lsof -i :80
sudo lsof -i :3001

# ç»“æŸè¿›ç¨‹
sudo kill -9 PID

```

#### 2. æƒé™é—®é¢˜

```
# é‡æ–°è®¾ç½®æƒé™
sudo chown -R www-data:www-data /var/www/lottery
sudo chmod -R 755 /var/www/lottery
```

#### 3. æŸ¥çœ‹æ—¥å¿—

```
# Nginx è®¿é—®æ—¥å¿—
sudo tail -f /var/log/nginx/lottery-access.log

# Nginx é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/lottery-error.log

# PM2 æ—¥å¿—
pm2 logs lottery-backend

# ç³»ç»Ÿæ—¥å¿—
sudo journalctl -u nginx -f

```

#### 4. æ„å»ºå¤±è´¥

```
# æ¸…ç†å¹¶é‡æ–°å®‰è£…
rm -rf node_modules package-lock.json
npm install --legacy-peer-deps
npm run build
```

---

### Ubuntu æ›´æ–°

```
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /home/lottery

# 2. æ‹‰å–æœ€æ–°ä»£ç 
git pull

# 3. å®‰è£…æ–°ä¾èµ–
npm install --legacy-peer-deps

# 4. é‡æ–°æ„å»º
npm run build

# 5. å¤åˆ¶æ–°æ–‡ä»¶
sudo cp -r dist/* /var/www/lottery/
sudo cp -r public/* /var/www/lottery/

# 6. é‡æ–°è®¾ç½®æƒé™
sudo chown -R www-data:www-data /var/www/lottery
sudo chmod -R 755 /var/www/lottery

# 7. é‡å¯åç«¯
pm2 restart lottery-backend

# 8. é‡æ–°åŠ è½½ Nginx
sudo systemctl reload nginx

```





## ğŸ“ é‡è¦æ–‡ä»¶ä½ç½® Ubuntu

| æ–‡ä»¶/ç›®å½•      | ä½ç½®                                 |
| -------------- | ------------------------------------ |
| é¡¹ç›®æºç        | `/home/lottery`                      |
| éƒ¨ç½²æ–‡ä»¶       | `/var/www/lottery`                   |
| Nginx é…ç½®     | `/etc/nginx/sites-available/lottery` |
| Nginx è®¿é—®æ—¥å¿— | `/var/log/nginx/lottery-access.log`  |
| Nginx é”™è¯¯æ—¥å¿— | `/var/log/nginx/lottery-error.log`   |
| PM2 é…ç½®       | `/home/lottery/ecosystem.config.js`  |

## ğŸ¯ å¿«é€Ÿå‚è€ƒ

### ç«¯å£è¯´æ˜

| æœåŠ¡                | ç«¯å£ | è¯´æ˜                                    |
| ------------------- | ---- | --------------------------------------- |
| å‰ç«¯ï¼ˆNginxï¼‰       | 80   | HTTP è®¿é—®                               |
| å‰ç«¯ï¼ˆNginx HTTPSï¼‰ | 443  | HTTPS è®¿é—®                              |
| åç«¯ API            | 3001 | å†…éƒ¨ä½¿ç”¨ï¼Œä¸å¯¹å¤–æš´éœ²                    |
| WebSocket           | 3001 | ä¸åç«¯åŒç«¯å£ï¼Œè·¯å¾„ `/ws/mobile-control` |

**Ubuntuï¼š**

```
# Nginx
sudo nginx -t                    # æµ‹è¯•é…ç½®
sudo systemctl reload nginx     # é‡æ–°åŠ è½½
sudo systemctl restart nginx    # é‡å¯

# PM2
pm2 status                      # æŸ¥çœ‹çŠ¶æ€
pm2 logs                        # æŸ¥çœ‹æ—¥å¿—
pm2 restart lottery-backend     # é‡å¯æœåŠ¡

# é˜²ç«å¢™
sudo ufw status                 # æŸ¥çœ‹çŠ¶æ€

```



1. ç™»å½•ç³»ç»Ÿï¼ˆä½¿ç”¨é»˜è®¤è´¦å· `admin` / å¯†ç  `admin123`ï¼‰
2. æ‰‹æœºæ‰«ç ï¼ŒéªŒè¯ç é»˜è®¤ï¼š123456
3. ç‚¹å‡»é½¿è½®å›¾æ ‡ âš™ï¸ è¿›å…¥é«˜çº§è®¾ç½®
4. è¾“å…¥é«˜çº§è®¾ç½®å¯†ç ï¼ˆé»˜è®¤ï¼š`admin888`ï¼‰

## Star History

[![Star History Chart](https://api.star-history.com/svg?repos=ctfwubai/ct-lottery&type=date&legend=top-left)](https://www.star-history.com/#ctfwubai/ct-lottery&type=date&legend=top-left)

